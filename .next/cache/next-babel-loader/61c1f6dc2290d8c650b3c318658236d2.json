{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nexports.__esModule = true;\nexports.closePing = closePing;\nexports.setupPing = setupPing;\nexports.currentPage = void 0;\nvar _unfetch = _interopRequireDefault(require(\"next/dist/build/polyfills/unfetch\"));\nvar _eventsource = require(\"./error-overlay/eventsource\"); /* global location */\nvar evtSource;\nvar currentPage;\nexports.currentPage = currentPage;\nfunction closePing() {\n  if (evtSource) evtSource.close();\n  evtSource = null;\n}\nfunction setupPing(assetPrefix, pathnameFn, retry) {\n  var pathname = pathnameFn(); // Make sure to only create new EventSource request if page has changed\n  if (pathname === currentPage && !retry) return;\n  exports.currentPage = currentPage = pathname; // close current EventSource connection\n  closePing();\n  var url = assetPrefix + \"/_next/webpack-hmr?page=\" + currentPage;\n  evtSource = (0, _eventsource.getEventSourceWrapper)({\n    path: url,\n    timeout: 5000,\n    ondemand: 1\n  });\n  evtSource.addMessageListener(function (event) {\n    if (event.data.indexOf('{') === -1) return;\n    try {\n      var payload = JSON.parse(event.data);\n      if (payload.invalid) {\n        // Payload can be invalid even if the page does not exist.\n        // So, we need to make sure it exists before reloading.\n        (0, _unfetch[\"default\"])(location.href, {\n          credentials: 'same-origin'\n        }).then(function (pageRes) {\n          if (pageRes.status === 200) {\n            location.reload();\n          }\n        });\n      }\n    } catch (err) {\n      console.error('on-demand-entries failed to parse response', err);\n    }\n  });\n}","map":{"version":3,"names":["_interopRequireDefault","require","exports","__esModule","closePing","setupPing","currentPage","_unfetch","_eventsource","evtSource","close","assetPrefix","pathnameFn","retry","pathname","url","getEventSourceWrapper","path","timeout","ondemand","addMessageListener","event","data","indexOf","payload","JSON","parse","invalid","location","href","credentials","then","pageRes","status","reload","err","console","error"],"sources":["F:/Next/google-books/node_modules/next/dist/client/dev/on-demand-entries-utils.js"],"sourcesContent":["\"use strict\";var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");exports.__esModule=true;exports.closePing=closePing;exports.setupPing=setupPing;exports.currentPage=void 0;var _unfetch=_interopRequireDefault(require(\"next/dist/build/polyfills/unfetch\"));var _eventsource=require(\"./error-overlay/eventsource\");/* global location */var evtSource;var currentPage;exports.currentPage=currentPage;function closePing(){if(evtSource)evtSource.close();evtSource=null;}function setupPing(assetPrefix,pathnameFn,retry){var pathname=pathnameFn();// Make sure to only create new EventSource request if page has changed\nif(pathname===currentPage&&!retry)return;exports.currentPage=currentPage=pathname;// close current EventSource connection\nclosePing();var url=assetPrefix+\"/_next/webpack-hmr?page=\"+currentPage;evtSource=(0,_eventsource.getEventSourceWrapper)({path:url,timeout:5000,ondemand:1});evtSource.addMessageListener(event=>{if(event.data.indexOf('{')===-1)return;try{var payload=JSON.parse(event.data);if(payload.invalid){// Payload can be invalid even if the page does not exist.\n// So, we need to make sure it exists before reloading.\n(0,_unfetch.default)(location.href,{credentials:'same-origin'}).then(pageRes=>{if(pageRes.status===200){location.reload();}});}}catch(err){console.error('on-demand-entries failed to parse response',err);}});}"],"mappings":"AAAA,YAAY;;AAAC,IAAIA,sBAAsB,GAACC,OAAO,CAAC,8CAA8C,CAAC;AAACC,OAAO,CAACC,UAAU,GAAC,IAAI;AAACD,OAAO,CAACE,SAAS,GAACA,SAAS;AAACF,OAAO,CAACG,SAAS,GAACA,SAAS;AAACH,OAAO,CAACI,WAAW,GAAC,KAAK,CAAC;AAAC,IAAIC,QAAQ,GAACP,sBAAsB,CAACC,OAAO,CAAC,mCAAmC,CAAC,CAAC;AAAC,IAAIO,YAAY,GAACP,OAAO,CAAC,6BAA6B,CAAC,CAAC;AAAqB,IAAIQ,SAAS;AAAC,IAAIH,WAAW;AAACJ,OAAO,CAACI,WAAW,GAACA,WAAW;AAAC,SAASF,SAASA,CAAA,EAAE;EAAC,IAAGK,SAAS,EAACA,SAAS,CAACC,KAAK,CAAC,CAAC;EAACD,SAAS,GAAC,IAAI;AAAC;AAAC,SAASJ,SAASA,CAACM,WAAW,EAACC,UAAU,EAACC,KAAK,EAAC;EAAC,IAAIC,QAAQ,GAACF,UAAU,CAAC,CAAC,CAAC;EACvjB,IAAGE,QAAQ,KAAGR,WAAW,IAAE,CAACO,KAAK,EAAC;EAAOX,OAAO,CAACI,WAAW,GAACA,WAAW,GAACQ,QAAQ,CAAC;EAClFV,SAAS,CAAC,CAAC;EAAC,IAAIW,GAAG,GAACJ,WAAW,GAAC,0BAA0B,GAACL,WAAW;EAACG,SAAS,GAAC,CAAC,CAAC,EAACD,YAAY,CAACQ,qBAAqB,EAAE;IAACC,IAAI,EAACF,GAAG;IAACG,OAAO,EAAC,IAAI;IAACC,QAAQ,EAAC;EAAC,CAAC,CAAC;EAACV,SAAS,CAACW,kBAAkB,CAAC,UAAAC,KAAK,EAAE;IAAC,IAAGA,KAAK,CAACC,IAAI,CAACC,OAAO,CAAC,GAAG,CAAC,KAAG,CAAC,CAAC,EAAC;IAAO,IAAG;MAAC,IAAIC,OAAO,GAACC,IAAI,CAACC,KAAK,CAACL,KAAK,CAACC,IAAI,CAAC;MAAC,IAAGE,OAAO,CAACG,OAAO,EAAC;QAAC;QACnS;QACA,CAAC,CAAC,EAACpB,QAAQ,WAAQ,EAAEqB,QAAQ,CAACC,IAAI,EAAC;UAACC,WAAW,EAAC;QAAa,CAAC,CAAC,CAACC,IAAI,CAAC,UAAAC,OAAO,EAAE;UAAC,IAAGA,OAAO,CAACC,MAAM,KAAG,GAAG,EAAC;YAACL,QAAQ,CAACM,MAAM,CAAC,CAAC;UAAC;QAAC,CAAC,CAAC;MAAC;IAAC,CAAC,QAAMC,GAAG,EAAC;MAACC,OAAO,CAACC,KAAK,CAAC,4CAA4C,EAACF,GAAG,CAAC;IAAC;EAAC,CAAC,CAAC;AAAC"},"metadata":{},"sourceType":"script"}